<!DOCTYPE html>
<html lang="en-US">

<head>
    <title>Snapshots</title>
    <script src="https://code.jquery.com/jquery-3.4.1.slim.js"></script>

    <script src="dist/js/datepicker.min.js"></script>
    <link href="dist/css/datepicker.min.css" rel="stylesheet" type="text/css"> 
    <!-- Include English language -->
    <script src="dist/js/i18n/datepicker.en.js"></script>

    <link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet" type="text/css"> 

    <link rel="stylesheet" href="style.css">
    <script src="main.js"></script>

    <script>
        const init = () => {
            adsBlocked( blocked => { //just runs our check and displays if ads are blocked or not.
                if(blocked) document.getElementById('result').innerHTML = 'ads are blocked.';
                else document.getElementById('result').innerHTML = 'ads are not blocked';
            } );
        }

        // Checks if ads are blocked by making a request to the default google ads site.
        // If it goes through, adblocking is off. If it gets stopped, adblocked is on. 
        const adsBlocked = ( callback ) => {
            let adURL = 'https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js';
            var requestInit = {method: 'HEAD', mode: 'no-cors'};

            let request = new Request(adURL, requestInit);

            fetch(request).then( response => {
                return response;
            }).then( response => {
                console.log(response);
                callback(false);
            }).catch( error => {
                console.log(error);
                callback(true);
            })
        }

        //Checks for adblocked once page is loaded. 
        document.addEventListener('DOMContentLoaded', init);
    </script>


</head>

<body>
    <div class="content">
        <h1>Snapshot Service</h1>

        <h2>Select a Date</h2>

        <div id="archive"> </div>

        <h2>Select a Product</h2>

        <div id="products" class="flex-container">
            <label class="product" id="barrons-label" for="prod-barrons">
                <input type="radio" id="prod-barrons" name="product" value="barrons" checked/>
                Barrons
            </label>
            <label class="product" id="wsj-label" for="prod-wsj">
                <input type="radio" id="prod-wsj" name="product" value="wsj"/>
                WSJ
            </label>
            <label class="product" id="fnlondon-label" for="prod-fnlondon">
                <input type="radio" id="prod-fnlondon" name="product" value="fnlondon"/>
                FNLondon
            </label>
        </div>

        <h2>Get the Snapshot</h2>

        <div class="flex-container">
            <div style="flex-grow: 1; margin-right:10px;">
                <h3>Download Full Snapshot</h3>
                <button class="download" style="width:100%;" onclick="downloadDate()">Download</button>
            </div>

            <div style="flex-grow: 1;">
                <h3>Download Page Screenshot (WIP)</h3>

                <div class="flex-container">
                    <select id="pages">
                        <option value="penta">Penta</option>
                        <option value="home">Home</option>
                        <option value="market-data">Market Data</option>
                        <option value="advisor-center">Advisor Center</option>
                    </select>
                    <select id="breakpoints">
                        <option value="4u">4u</option>
                        <option value="8u">8u</option>
                        <option value="12u">12u</option>
                        <option value="16u">16u</option>
                    </select>
                    <button class="download" onclick="downloadScreenshot()" style="flex-grow: 2; ">Download</button-->
                </div>
            </div>

            
        </div>

    </div>

    <p id="result">HI ADS!!</p>
</body>

</html>